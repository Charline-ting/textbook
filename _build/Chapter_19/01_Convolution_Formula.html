---
redirect_from:
  - "/chapter-19/01-convolution-formula"
interact_link: content/Chapter_19/01_Convolution_Formula.ipynb
kernel_name: python3
kernel_path: content/Chapter_19
has_widgets: false
title: |-
  The Convolution Formula
pagenum: 98
prev_page:
  url: /Chapter_19/00_Distributions_of_Sums.html
next_page:
  url: /Chapter_19/02_Moment_Generating_Functions.html
suffix: .ipynb
search: s x lambda y density formula let convolution random variables sum p infty dx e xy independent joint fs discrete values text becomes continuous f given int iid exponential d align ints end gamma chapter sums sometimes uniform u stripes linearly between triangle good distribution partition event according straightforward analog fx fy neither nor exceed says begin thats consistent claim made previous found without where uis gold graph below show events ds various surface flat shape depends only lengths increase decrease triangular height since area difficulty scale integral quite intractable rest develop different identifying distributions

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">The Convolution Formula</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Convolution-Formula">The Convolution Formula<a class="anchor-link" href="#The-Convolution-Formula"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let $X$ and $Y$ be discrete random variables and let $S = X+Y$. We know that a good way to find the distribution of $S$ is to partition the event $\{ S = s\}$ according to values of $X$. That is,</p>
$$
P(S = s) ~ = ~ \sum_{\text{all }x} P(X = x, Y = s-x)
$$<p>If $X$ and $Y$ are independent, this becomes the <em>discrete convolution formula</em>:</p>
$$
P(S = s) ~ = ~ \sum_{\text{all }x} P(X = x)P(Y = s-x)
$$<p>This formula has a straightforward continuous analog. Let $X$ and $Y$ be continuous random variables with joint density $f$, and let $S = X+Y$. Then the density of $S$ is given by</p>
$$
f_S(s) ~ = ~ \int_{-\infty}^\infty f(x, s-x)dx
$$<p>which becomes the <em>convolution formula</em> when $X$ and $Y$ are independent:</p>
$$
f_S(s) ~ = ~ \int_{-\infty}^\infty f_X(x)f_Y(s-x)dx
$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sum-of-Two-IID-Exponential-Random-Variables">Sum of Two IID Exponential Random Variables<a class="anchor-link" href="#Sum-of-Two-IID-Exponential-Random-Variables"> </a></h3><p>Let $X$ and $Y$ be i.i.d. exponential $(\lambda)$ random variables and let $S = X+Y$. For the sum to be $s &gt; 0$, neither $X$ nor $Y$ can exceed $s$. The convolution formula says that the density of $S$ is given by</p>
$$
\begin{align*}
f_S(s) ~ &amp;= ~ \int_0^s \lambda e^{-\lambda x} \lambda e^{-\lambda(s-x)} dx \\ \\
&amp;= ~ \lambda^2 e^{-\lambda s} \int_0^s dx \\ \\
&amp;=~  \lambda^2 s e^{-\lambda s}
\end{align*}
$$<p>That's the gamma $(2, \lambda)$ density, consistent with the claim made in the previous chapter about sums of independent gamma random variables.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes, the density of a sum can be found without the convolution formula.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sum-of-Two-IID-Uniform-$(0,-1)$-Random-Variables">Sum of Two IID Uniform $(0, 1)$ Random Variables<a class="anchor-link" href="#Sum-of-Two-IID-Uniform-$(0,-1)$-Random-Variables"> </a></h3><p>Let $S = U_1 + U_2$ where the $U_i$'s are i.i.d. uniform on $(0, 1)$. The gold stripes in the graph below show the events $\{ S \in ds \}$ for various values of $S$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered tag_remove_input">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/Chapter_19/01_Convolution_Formula_5_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The joint density surface is flat. So the shape of the density of $S$ depends only on the lengths of the stripes, which increase linearly between $s = 0$ and $s = 1$ and then decrease linearly between $s = 1$ and $s = 2$. So the joint density of $S$ is triangular. The height of the triangle is 1 since the area of the triangle has to be 1.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered tag_remove_input">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/Chapter_19/01_Convolution_Formula_7_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At the other end of the difficulty scale, the integral in the convolution formula can sometimes be quite intractable. In the rest of the chapter we will develop a different way of identifying distributions of sums.</p>

</div>
</div>
</div>
</div>

 


    </main>
    