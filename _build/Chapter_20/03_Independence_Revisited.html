---
redirect_from:
  - "/chapter-20/03-independence-revisited"
interact_link: content/Chapter_20/03_Independence_Revisited.ipynb
kernel_name: python3
kernel_path: content/Chapter_20
has_widgets: false
title: |-
  Independence, Revisited
pagenum: 105
prev_page:
  url: /Chapter_20/02_Prior_and_Posterior.html
next_page:
  url: /Chapter_21/00_The_Beta_and_the_Binomial.html
suffix: .ipynb
search: p x toss text head coin heads mid density given tosses second let chance fx int lands cdot frac posterior dx both align lets event our dp uniform calculation independence e random thus r twice results fair also not begin end f vert near towards earlier revisited section remind ourselves happen parameters randomized basics average conditional probabilities sim dxp compact notation example finding expectation conditioning any unit interval think value probability once recall definition means beta s distribution rs observe just observed behaves same shows based knowledge figure land thats greater tossing independent whats going here therefore clearly knowing telling

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Independence, Revisited</div>
</div>
    
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Independence,-Revisited">Independence, Revisited<a class="anchor-link" href="#Independence,-Revisited"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this section we will remind ourselves about what can happen to independence when parameters are randomized. First, let's go over some basics.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Average-Conditional-Probabilities">Average Conditional Probabilities<a class="anchor-link" href="#Average-Conditional-Probabilities"> </a></h3><p>Let $X$ have density $f_X$ and let $A$ be an event. Then</p>
$$
P(A, X \in dx) ~ = ~ P(X \in dx)P(A \mid X = x) ~ \sim ~ f_X(x)dxP(A \mid X = x)
$$<p>So</p>
$$
P(A) ~ = ~ \int_{\text{all x}} P(A, X \in dx) ~ = ~ \int_{\text{all x}} P(A \mid X = x)f_X(x)dx
$$<p>In more compact notation, $P(A) = E(P(A \mid X))$. This is an example of finding expectation by conditioning.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="One-Toss-of-a-Random-Coin">One Toss of a Random Coin<a class="anchor-link" href="#One-Toss-of-a-Random-Coin"> </a></h3><p>Let $X$ have any density on the unit interval $(0, 1)$. Think of the value of $X$ as the the probability that a coin lands heads. Toss the coin once. Recall that our definition of "given $X=p$" means that</p>
$$
P(\text{coin lands heads} \mid X = p) = p
$$<p>Let $X$ have density $f_X$. Then</p>
$$
P(\text{coin lands heads}) ~ = ~ \int_0^1 p \cdot f_X(p)dp ~ = ~ E(X)
$$<p>Thus if $X$ is uniform on $(0, 1)$, then the chance that the coin lands heads is $1/2$. If $X$ has the beta $(r, s)$ distribution then the chance that the coin lands heads is $r/(r+s)$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Two-Tosses-of-the-Random-Coin">Two Tosses of the Random Coin<a class="anchor-link" href="#Two-Tosses-of-the-Random-Coin"> </a></h3><p>Let $X$ be uniform on $(0, 1)$. Given $X = p$, toss a $p$-coin twice and observe the results of the tosses.</p>
<p>We have just observed that $P(\text{first toss is a head}) = 1/2$. The first toss behaves like the toss of a fair coin. The same calculation shows that the chance that the second toss is a head (based on no knowledge of the first toss) is also $1/2$.</p>
<p>Now let's figure out the chance that both the tosses land heads. We know that $P(\text{both tosses are heads} \mid X = p) = p^2$. So</p>
$$
P(\text{both tosses are heads}) ~ = ~ \int_0^1 p^2 \cdot 1dp ~ = ~ \frac{1}{3}
$$<p>That's <em>greater than</em> $1/4$ which is the chance of two heads given that you are tossing a fair coin twice. <strong>The results of the two tosses are not independent.</strong></p>
<p>Let's see what's going on here. We know that</p>
$$
\begin{align*}
P(\text{both tosses are heads}) ~ &amp;= ~ P(\text{first toss is a head})
P(\text{second toss is a head} \mid \text{first toss is a head}) \\
&amp;= ~ \frac{1}{2} P(\text{second toss is a head} \mid \text{first toss is a head})
\end{align*}
$$<p>Therefore</p>
$$
P(\text{second toss is a head} \mid \text{first toss is a head}) ~ = ~ \frac{2}{3} ~ &gt; ~ \frac{1}{2}
$$<p>Clearly, knowing that the first toss is a head is telling us something about $X$, which is then reflected is the chance that the second toss is also a head.</p>
<p>To quantify this idea, we will find the posterior density of $X$ given that the first toss is a head. Let $A$ be the event that the first toss is heads. The posterior density given this event is proportional to the prior times the likelihood of $A$. Thus it can be calculated as</p>
$$
f_{X \vert A} (x) ~ \propto ~ 1 \cdot p
$$<p>This posterior density of $X$ given that the first toss is a head is not uniform. It rises linearly and puts more of its mass on values near 1 than near 0.</p>
<p>This makes sense: given that the first toss is a head, we are more inclined to believe that the coin is biased towards heads than towards tails.</p>
<p>The constant of integration is easy to find. The posterior density given that the first toss is a head is $f_{X \vert A} (p) = 2p$ for $p \in (0, 1)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/Chapter_20/03_Independence_Revisited_5_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To double-check our earlier calculation, we can find $P(\text{second toss is a head} \mid \text{first toss is a head})$ using this posterior density.</p>
$$
\begin{align*}
P(\text{second toss is a head} \mid \text{first toss is a head}) 
~ &amp;= ~ \int_0^1 p \cdot 2p \cdot dp \\
&amp;= ~ \frac{2}{3}
\end{align*}
$$<p>This is consistent with our earlier calculation.</p>

</div>
</div>
</div>
</div>

 


    </main>
    